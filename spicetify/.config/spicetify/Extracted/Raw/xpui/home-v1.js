"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[270],{71121:(e,t,n)=>{n.r(t),n.d(t,{HOME_REFRESH_TIMEOUT:()=>R,default:()=>D});var s=n(67294),a=n(94184),r=n.n(a),o=n(28216),i=n(73526),c=n(96206),l=n(70369),u=n(8507),m=n(1663),d=n(86964),f=n(35533),_=n(87577),g=n(87961),p=n(33607),y=n(23716),E=n(74845),h=n(8247),v=n(8271);const S="PLAY_AT_FIRST_TAP_HAD_DEFERRED_ACTIONS";function b(e){const t=(0,_.W6)(h.Qs),[n,a]=(0,s.useState)(void 0),[r,i]=(0,s.useState)(void 0),[c,l]=(0,s.useState)(!1),u=(0,y.g)(),m=(0,o.v9)((({session:e})=>e.user&&e.user.id)),d=(0,v.s4)(),b=(0,s.useCallback)((function(e){const t=(0,f.x)(e);d.send(t)}),[d]);(0,s.useEffect)((()=>{i(!!window.sessionStorage.getItem(S)&&(window.sessionStorage.removeItem(S),!0))}),[]),(0,s.useEffect)((()=>{m&&(b({category:"play-at-first-tap",label:"log_attempt",os:(0,p.y)(),context:"ab_v3"}),l((e=>!!window.sessionStorage.getItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`))(m)),(0,E.M)(g.b.getInstance()).then((e=>{a(e.content.items.length>0)})).catch((()=>{b({category:"play-at-first-tap",label:"recently-played-failed",os:(0,p.y)(),context:"ab_v3"}),a(!0)})))}),[m,b]),(0,s.useEffect)((()=>{if(void 0===n||void 0===r||!e||!m||c)return;const s=!n&&!r;if(s){(e=>{window.sessionStorage.setItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`,JSON.stringify(!0))})(m);const n=(e=>{const t=e.content.items.find((e=>{const t="CAROUSEL"===e.rendering,n="LIST"===e.rendering&&"shortcuts"!==e.id;return t||n}));if(!t)return;const n=t.content.items.find((e=>!e.publisher||!e.publisher.startsWith("Spotify")));return n&&n.uri})(e);n&&t&&u.play({uri:n},{featureIdentifier:"home",referrerIdentifier:"home"},{paused:!0}),b({category:"play-at-first-tap",label:"play_content",os:(0,p.y)(),context:n||"no_valid_uri_retrieved"})}b({category:"play-state",label:s?"has_valid_state_yes":"has_valid_state_no",os:(0,p.y)(),context:"ab_v3"})}),[c,n,e,r,u,m,t,b])}var A=n(13983),I=n(29255),w=n(42922),T=n(54444),P=n(23809),F=n(23060),k=n(29393),L=n(16896);const R=18e5,D=s.memo((function(){const{isAnonymous:e}=(0,o.v9)(I.Gg),t=(0,k.v8)(e),{view:n}=(0,P.P)(t,{cacheTime:R}),{spec:a,UBIFragment:f}=(0,T.fU)(i.createDesktopHomeEventFactory,{data:{identifier:t,uri:"spotify:home"}});(0,A.z)("home"),b(n);const _=n?.content.items,[g,p]=(0,s.useMemo)((()=>{const e=[];let t=null;if(Array.isArray(_))for(let n=0;n<_.length;n++){const s=_[n];"shortcuts"===s.id?t=s:e.push(s)}return[t,e]}),[_]);return s.createElement(f,{spec:a},s.createElement(l.$,null,c.ag.get("page.generic-title")),s.createElement(s.Suspense,{fallback:null},s.createElement(F.S,null)),n?s.createElement("section",{"data-testid":"home-page"},s.createElement("div",{className:L.Z.home},s.createElement("div",{className:r()(L.Z.content,"contentSpacing")},g?s.createElement(f,{spec:a.shortcutsFactory()},s.createElement(w.JL,{value:"headered-grid",key:g.id},s.createElement(u.n,{items:g.content.items,title:g.name,tagline:g.tag_line}))):null,s.createElement(f,{spec:a.shelvesFactory()},s.createElement(d.c,{spaces:p,viewName:n.name,viewId:t,isAnonymous:e}))))):s.createElement(m.h,{hasError:!1,errorMessage:c.ag.get("error.not_found.title.page")}))}))}}]);
//# sourceMappingURL=home-v1.js.map